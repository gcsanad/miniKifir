let diakok = [
  {
    "OM_Azonosito": "01234567890",
    "Neve": "Balogh Andrea",
    "Email": "balogh.andrea@example.com",
    "SzuletesiDatum": "1999-03-03T00:00:00",
    "ErtesitesiCime": "Székesfehérvár, Eper utca 707",
    "Matematika": 48,
    "Magyar": 42
  },
  {
    "OM_Azonosito": "01234987654",
    "Neve": "Balogh Tamás",
    "Email": "balogh.tamas@example.com",
    "SzuletesiDatum": "2000-04-25T00:00:00",
    "ErtesitesiCime": "Székesfehérvár, Cseresznyefa utca 12",
    "Matematika": 40,
    "Magyar": 50
  },
  {
    "OM_Azonosito": "12345098765",
    "Neve": "Király Gergő",
    "Email": "kiraly.gergo@example.com",
    "SzuletesiDatum": "1994-02-28T00:00:00",
    "ErtesitesiCime": "Budapest, Áfonya utca 12",
    "Matematika": 35,
    "Magyar": 45
  },
  {
    "OM_Azonosito": "12345678901",
    "Neve": "Kovács Péter",
    "Email": "kovacs.peter@example.com",
    "SzuletesiDatum": "1995-05-15T00:00:00",
    "ErtesitesiCime": "Budapest, Körte utca 123",
    "Matematika": 45,
    "Magyar": 35
  },
  {
    "OM_Azonosito": "23456109876",
    "Neve": "Nagy Zsolt",
    "Email": "nagy.zsolt@example.com",
    "SzuletesiDatum": "1997-09-05T00:00:00",
    "ErtesitesiCime": "Debrecen, Barackvirág utca 56",
    "Matematika": 0,
    "Magyar": 30
  },
  {
    "OM_Azonosito": "23456789012",
    "Neve": "Nagy Anna",
    "Email": "nagy.anna@example.com",
    "SzuletesiDatum": "1998-08-22T00:00:00",
    "ErtesitesiCime": "Debrecen, Alma utca 456",
    "Matematika": 30,
    "Magyar": 20
  },
  {
    "OM_Azonosito": "34567210987",
    "Neve": "Kiss Eszter",
    "Email": "kiss.eszter@example.com",
    "SzuletesiDatum": "1991-11-17T00:00:00",
    "ErtesitesiCime": "Szeged, Diófa utca 34",
    "Matematika": 40,
    "Magyar": 48
  },
  {
    "OM_Azonosito": "34567890123",
    "Neve": "Kiss Gábor",
    "Email": "kiss.gabor@example.com",
    "SzuletesiDatum": "1990-12-01T00:00:00",
    "ErtesitesiCime": "Szeged, Szilva utca 789",
    "Matematika": 50,
    "Magyar": 40
  },
  {
    "OM_Azonosito": "45678321098",
    "Neve": "Tóth Attila",
    "Email": "toth.attila@example.com",
    "SzuletesiDatum": "1998-06-23T00:00:00",
    "ErtesitesiCime": "Pécs, Málna utca 78",
    "Matematika": 42,
    "Magyar": 37
  },
  {
    "OM_Azonosito": "45678901234",
    "Neve": "Tóth Erika",
    "Email": "toth.erika@example.com",
    "SzuletesiDatum": "1993-04-10T00:00:00",
    "ErtesitesiCime": "Pécs, Körte utca 101",
    "Matematika": 40,
    "Magyar": 0
  },
  {
    "OM_Azonosito": "56789012345",
    "Neve": "Molnár János",
    "Email": "molnar.janos@example.com",
    "SzuletesiDatum": "1997-06-28T00:00:00",
    "ErtesitesiCime": "Szombathely, Barack utca 202",
    "Matematika": 0,
    "Magyar": 30
  },
  {
    "OM_Azonosito": "56789432109",
    "Neve": "Molnár Judit",
    "Email": "molnar.judit@example.com",
    "SzuletesiDatum": "1993-03-08T00:00:00",
    "ErtesitesiCime": "Szombathely, Füge utca 90",
    "Matematika": 38,
    "Magyar": 0
  },
  {
    "OM_Azonosito": "67890123456",
    "Neve": "Horváth Judit",
    "Email": "horvath.judit@example.com",
    "SzuletesiDatum": "1994-09-17T00:00:00",
    "ErtesitesiCime": "Győr, Meggy utca 303",
    "Matematika": 35,
    "Magyar": 50
  },
  {
    "OM_Azonosito": "67890543210",
    "Neve": "Horváth Gábor",
    "Email": "horvath.gabor@example.com",
    "SzuletesiDatum": "1996-08-14T00:00:00",
    "ErtesitesiCime": "Győr, Mézvirág utca 23",
    "Matematika": 47,
    "Magyar": 29
  },
  {
    "OM_Azonosito": "78901234567",
    "Neve": "Szabó István",
    "Email": "szabo.istvan@example.com",
    "SzuletesiDatum": "1996-01-05T00:00:00",
    "ErtesitesiCime": "Miskolc, Dió utca 404",
    "Matematika": 45,
    "Magyar": 25
  },
  {
    "OM_Azonosito": "78901654321",
    "Neve": "Szabó Eszter",
    "Email": "szabo.eszter@example.com",
    "SzuletesiDatum": "1992-01-30T00:00:00",
    "ErtesitesiCime": "Miskolc, Bodza utca 45",
    "Matematika": 49,
    "Magyar": 42
  },
  {
    "OM_Azonosito": "89012345678",
    "Neve": "Varga Zsófia",
    "Email": "varga.zsofia@example.com",
    "SzuletesiDatum": "1992-11-20T00:00:00",
    "ErtesitesiCime": "Nyíregyháza, Cseresznye utca 505",
    "Matematika": 50,
    "Magyar": 30
  },
  {
    "OM_Azonosito": "89012765432",
    "Neve": "Varga Attila",
    "Email": "varga.attila@example.com",
    "SzuletesiDatum": "1988-05-19T00:00:00",
    "ErtesitesiCime": "Nyíregyháza, Meggyfa utca 67",
    "Matematika": 0,
    "Magyar": 36
  },
  {
    "OM_Azonosito": "90123456789",
    "Neve": "Fekete Balázs",
    "Email": "fekete.balazs@example.com",
    "SzuletesiDatum": "1989-07-12T00:00:00",
    "ErtesitesiCime": "Kecskemét, Sárgabarack utca 606",
    "Matematika": 0,
    "Magyar": 28
  },
  {
    "OM_Azonosito": "90123876543",
    "Neve": "Fekete Zsuzsa",
    "Email": "fekete.zsuzsa@example.com",
    "SzuletesiDatum": "1995-10-11T00:00:00",
    "ErtesitesiCime": "Kecskemét, Szeder utca 89",
    "Matematika": 32,
    "Magyar": 47
  },
  {
    "OM_Azonosito": "43225435452",
    "Neve": "Molnár Noémi Judit",
    "Email": "molnar.noemi.judit@gmail.com",
    "SzuletesiDatum": "2005-10-07T00:00:00",
    "ErtesitesiCime": "Nagyvárad, József Attila utca 69.",
    "Matematika": 50,
    "Magyar": 50
  }
]
const TABLAZAT = document.getElementById("tablazat")
const OMTABLAZAT = document.getElementById("OMtablazat")
let listabanLevoElemek = 0;
let magyAtlag = 0;
let matAtlag = 0;
let osszAtlag = 0;

var inputText = document.getElementById("selOmAzonosito");

function Kereses() {
  listabanLevoElemek = 0
  magyAtlag = 0
  matAtlag = 0
  osszAtlag = 0
  OMTABLAZAT.innerHTML = ""
  OMTABLAZAT.innerHTML = `<tr>
                          <th id="elso_OM">OM</th>
                          <th id="elso_Nev">Név</th>
                          <th id="elso_Email">Email</th>
                          <th id="elso_Ertesitesi">Értesítési cím</th>
                          <th id="elso_Szuletesi">Születési dátum</th>
                          <th id="elso_Matek">Matek</th>
                          <th id="elso_Magyar">Magyar</th>
                          </tr>`

  for (const diak of diakok) {
    if (diak.OM_Azonosito.startsWith(inputText.value) && inputText.value != "") {
      let ujSor = document.createElement("tr")
      ujSor.innerHTML = `<td>${diak.OM_Azonosito}</td>
      <td>${diak.Neve}</td>
      <td>${diak.Email}</td>
      <td>${diak.ErtesitesiCime}</td>
      <td>${diak.SzuletesiDatum.substring(0, 10)}</td>
      <td>${diak.Matematika}</td>
      <td>${diak.Magyar}</td>`
      listabanLevoElemek++
      magyAtlag += parseInt(diak.Magyar)
      matAtlag += parseInt(diak.Matematika)
      osszAtlag += parseInt(diak.Magyar) + parseInt(diak.Matematika)
      ujSor.addEventListener('click', (event) => {

        const TREK = document.querySelectorAll("tr");
        TREK.forEach(element => {
          element.classList = "";
          element.id = "";
        });
        event.target.parentElement.classList.add("kivalasztott")
        event.target.parentElement.id = "lekeres"

        let kivalasztottLekerese = document.getElementById("lekeres");
        console.log(parseInt(kivalasztottLekerese.getElementsByTagName("td")[5].innerHTML) + parseInt(kivalasztottLekerese.getElementsByTagName("td")[6].innerHTML))
        if (TABLAZAT.children.length > 1) {
          while (TABLAZAT.children.length > 1) {
            TABLAZAT.removeChild(TABLAZAT.lastChild)
          }
          for (const diak of diakok) {
            if (diak.Magyar + diak.Matematika >= parseInt(kivalasztottLekerese.getElementsByTagName("td")[5].innerHTML) + parseInt(kivalasztottLekerese.getElementsByTagName("td")[6].innerHTML) && diak.OM_Azonosito != kivalasztottLekerese.getElementsByTagName("td")[0].innerHTML) {
              let ujSor = document.createElement("tr")

              let ujOM = document.createElement("td")
              ujOM.innerText = diak.OM_Azonosito
              ujSor.append(ujOM)
              let ujNev = document.createElement("td")
              ujNev.innerText = diak.Neve
              ujSor.appendChild(ujNev)

              TABLAZAT.appendChild(ujSor)

            }
          }
        }
        else {

          for (const diak of diakok) {
            if (diak.Magyar + diak.Matematika >= parseInt(kivalasztottLekerese.getElementsByTagName("td")[5].innerHTML) + parseInt(kivalasztottLekerese.getElementsByTagName("td")[6].innerHTML) && diak.OM_Azonosito != kivalasztottLekerese.getElementsByTagName("td")[0].innerHTML) {
              let ujSor = document.createElement("tr")

              let ujOM = document.createElement("td")
              ujOM.innerText = diak.OM_Azonosito
              ujSor.append(ujOM)
              let ujNev = document.createElement("td")
              ujNev.innerText = diak.Neve
              ujSor.appendChild(ujNev)

              TABLAZAT.appendChild(ujSor)

            }
          }
        }
      })
      OMTABLAZAT.appendChild(ujSor)






    }

  }
  magyAtlag = Math.round(magyAtlag / listabanLevoElemek*10)/10
  matAtlag = Math.round(matAtlag / listabanLevoElemek*10)/10
  osszAtlag = Math.round(osszAtlag / listabanLevoElemek*10)/10
  if (isNaN(matAtlag)) {
    document.getElementById("listabanElemek").innerHTML = listabanLevoElemek
    document.getElementById("matekOssz").innerHTML = ""
    document.getElementById("magyOssz").innerHTML = ""
    document.getElementById("osszAtl").innerHTML = ""
  }
  else {
    document.getElementById("listabanElemek").innerHTML = listabanLevoElemek
    document.getElementById("matekOssz").innerHTML = matAtlag
    document.getElementById("magyOssz").innerHTML = magyAtlag
    document.getElementById("osszAtl").innerHTML = osszAtlag

  }

}

